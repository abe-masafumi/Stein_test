<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>test document</title>
</head>

<body>

  <header>
    title
  </header>
  <main>
    <input id="serach" type="text" placeholder="æ¤œç´¢" style="font-size: 16px;">
    <div style="display: flex;">
      <input id="addform" type="text" placeholder="è¿½åŠ " style="font-size: 16px;">
      <button id="addbutton">ç™»éŒ²</button>
    </div>
    <input id="editform" type="text" placeholder="ç·¨é›†" style="font-size: 16px;">
    <ul class="no_schedule" id="searchul" data-title="" data-author="">

    </ul>
    <ul id="ul">
    </ul>

  </main>
  <script src="https://unpkg.com/stein-js-client"></script>
  <script>
    const ul = document.getElementById('ul')
    const editform = document.getElementById('editform');
    const searchul = document.getElementById('searchul');

    const store = new SteinStore(
      "https://api.steinhq.com/v1/storages/63a5a77dd27cdd09f0d14d74"
    );
    let get
    store.read("ã‚·ãƒ¼ãƒˆ1", { limit: 100, offset: 0 }).then(data => {
      console.dir(data);
      get = data
      console.log(" - - - - - - - - - - - ");
      for (let i = 0; i < data.length; i++) {
        const element = data[i];
        const li = document.createElement('li')
        const div = document.createElement('div')
        div.style = "display:flex;"
        const p = document.createElement('p')
        const edit = document.createElement('span')
        edit.textContent = "ðŸ˜­"
        edit.style = "margin:16px"
        edit.data = element.ç™»éŒ²
        p.textContent = element.ç™»éŒ²
        div.appendChild(p)
        div.appendChild(edit)
        li.appendChild(div)
        ul.appendChild(li)
        edit.addEventListener("click", (e) => {
          if (editform.value == "") {
            return
          }
          store.edit("ã‚·ãƒ¼ãƒˆ1", {
            search: { ç™»éŒ²: edit.data },
            set: { ç™»éŒ²: editform.value }
          })
            .then(res => {
              console.log(res);
              window.location.reload();
            });
        })
      }
    });

    const addform = document.getElementById('addform');
    const addbutton = document.getElementById('addbutton');
    function edit() {
    }
    function add() {
      console.log(addform.value)
      store.append("ã‚·ãƒ¼ãƒˆ1", [{ ç™»éŒ²: addform.value }])
        .then(res => {
          console.log(res);
          window.location.reload();
        });
    }

    addbutton.addEventListener("click", () => {
      add();
    });

    const serach = document.getElementById('serach')
    serach.addEventListener('change', (e) => {
      const keyword = e.target.value;
      const $schedules = document.querySelectorAll("#ul > li");
      if (keyword) {
        console.log(get);
        var matched = get.filter(function (obj) {
          return obj.ç™»éŒ².match(keyword);
        });

        console.log(matched);
        for (i = 0; i < matched.length; i++) {
          const searchli = document.createElement('li')
          console.log(matched[i].ç™»éŒ²);
          searchli.textContent = matched[i].ç™»éŒ²
          searchul.appendChild(searchli)
        }
      } else {
        console.log("Kara");
      }
    })
  </script>
</body>

</html>